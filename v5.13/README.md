# About directory

This directory contains the Juptyer notebook and code for performing tests against the Dataverse API version 5.13.

## Using this notebook

Copy the `_config.dataverseTest.example.json` file and rename it to `_config.dataverseTest.json` (or whatever you want to call it). Within the first code block of the `dataverseTest.ipynb` notebook you will tell the notebook the filename of the configuration file:

`objWorker = Worker("_config_dataverseTest.json")`

The `strDvApi_TOKEN` variable will need to be set to the Dataverse API token you have created through your Dataverse account. I use `https://demo-dataverse.rdmc.unc.edu` as one of the testing environments.

## The tools I use

I use VSCode editor for Windows and the `Markdown All in One` extension. I also use Docker Desktop to 
start a local Jupyter Server from a WSL terminal in VSCode. The commands I use are:

Switch the directory in the terminal to the location of the notebook file.

`cd "/mnt/c/Users/pgale/OneDrive - University of North Carolina at Chapel Hill/TARC/Code/GitHubRepos/dv-api-test/v5.13"`

Start the Jupyter server using Docker.

`docker run -it --name 364-dp-DataverseApiTest --mount type=bind,source="$(pwd)",target="/home/jovyan/work" --add-host=host.docker.internal:host-gateway -p 10000:8888 quay.io/jupyter/scipy-notebook:latest`

I then go to the web browser and open `http://localhost:10000/lab/` which is the login page for the Jupyter Server that is now running in Docker. You will need to copy the `key` from the command line and paste it into the login screen to access Jupyter Lab, to work with the notebook.

Of course you can use your Jupyter notebook service of choice (e.g. Google Colab), but you will need to alter some the configuration settings in the `_config.dataverseTest.json` file.

## About the configuration file

Below is an explanation of some key variables found in the configuration file.

- `strDOCKER_WORKING_DIR` defines the internal working path of the Docker image I mention above when to working with the notebook using the Docker command
- `strLOCAL_UPLOAD_DIR` the name I gave to the local folder generated by the notebook when creating test files to send to the Dataverse API
- `blnSHOW_DEBUG_STATEMENTS` a boolean flag (0="do not show debug statements in the notebook", 1="show debug statements within the notebook output")
- `blnSHOW_CURL_COMMANDS` a boolean flag (0="do not show CURL statements in the notebook", 1="show CURL statements within the notebook output")
- `lstTEST_FILES` a list of test files to generate for the API tests
- `lstTEST_FILES2` a second set of test files to generate for the API tests
- `strDvApi_DOMAIN` the Dataverse domain you are using
- `strDvApi_NAME` name you want to provide for your Dataverse 
- `strDvApi_PARENT_COLLECTION` the Dataverse collection alias your Dataverse will be stored under
- `strDvApi_TOKEN` your Dataverse API token
- `objDvApi_COLLECTION_START` the properties you will use to initialize your Dataverse
- `objDvApi_DATASET_INIT` - you can use this object to initialize a dataset and contains most of the default metadata fields **note: we intentionally leave the `datasetVersion` element out of the metadata so we can use the same metadata for both the creation of the dataset and update**
- `objDvApi_DATASET_INIT_PART` - this is another dataset initialization object
- `objDvApi_DATASET_UPDATE` - this is another dataset initialization object that we can use to update the dataset metadata
